---
title: xray-clawdbot-memory
date: 2026-02-14 09:35
tags: [read, xray, article]
identifier: 20260214T093520
source: https://manthanguptaa.in/posts/clawdbot_memory/
---

# WISDOM CORE

```
+--------------------------------------------------+
|                                                  |
|   记忆 = 结构化存储 (Markdown) x 混合检索 (RAG)     |
|                                                  |
+--------------------------------------------------+
```

将非结构化的对话流，通过自动化摘要与语义索引，转化为可被精准调用的结构化资产。

# LAYER 1: SURFACE SCAN

**主题域**: AI 代理长期记忆机制框架。

**核心论点**: Clawdbot 通过将本地 Markdown 文件与混合检索（向量+关键词）结合，实现了透明、廉价且无限增长的 AI 长期记忆系统。

**论据支撑**:
- Clawdbot 的 context 构成：系统提示词 + 项目背景 (Markdown) + 对话历史。
- 记忆架构分层：MEMORY.md (长期精华) 与 memory/*.md (每日流水)。
- 检索机制：使用 sqlite-vec (语义) 与 FTS5 (关键词) 进行 7:3 权重混合评分。
- 自动维护：具备“预压缩记忆冲刷”机制，在上下文溢出前自动落盘关键信息。

# LAYER 2: DEEP PENETRATION

**问题意识**: 云端 AI（如 ChatGPT）记忆不透明且不可控，如何构建一个用户完全所有、且在长周期任务中不丢失关键信息的本地记忆系统？

**思维模型**: **两层存储模型 (Two-Layer Storage)** —— 将“正在发生的流”与“固化下来的桩”分类处理。

**隐含假设**: 纯文本 (Markdown) 是最经得起时间考验、最易于人机共读的知识载体。

**反常识点**: 并没有专门的 `memory_write` 工具。记忆的“写”操作复用了通用的文件系统，将“记忆”降维成了“文件管理”。

# LAYER 3: CORE LOCALIZATION

**智慧公式**: `持久价值 = 原始输入 - 摘要熵损 + 结构化检索`

**适用边界**:
- 成立: 任务周期长、涉及大量历史决定、需要跨平台一致性。
- 失效: 瞬时性强、无复用价值的噪音对话，会导致索引膨胀。

**迁移潜力**: 个人知识库建设, 法律案卷管理, 软件项目重构文档。

# LAYER 4: WISDOM TOPOLOGY

**智慧连接**: 与“第二大脑” (Second Brain) 理论及 Zettelkasten 卡片盒笔记法高度契合。

**认知跃迁**: 记忆只是对话历史 --> 记忆是动态维护、按需加载的本地资产库。

**行动启示**:
1. 重要的事写出来：利用 `MEMORY.md` 强制固化长期事实。
2. 保持文件透明：直接编辑本地 Markdown 来修正 AI 的理解偏见。
3. 容忍低损耗：接受压缩带来的微量丢失，但确保核心节点已在冲刷期落盘。

# ARGUMENT TOPOLOGY

```
[User Input] ----> [Context Buffer (Short-term)]
                         |
      /------------------+------------------\
      |                  |                  |
[Search Tool]      [Flush Loop]      [Compaction]
      |                  |                  |
      V                  V                  V
[Hybrid Index] <-- [Markdown Files] <--- [Summary Core]
(Semantic+FTS)      (MEMORY.md)
```

# TRANSFER MATRIX

**个人知识库**: 将零散笔记（输入）通过 LLM 自动标签化与关联（机制）--> `知识深度 = 积累量 x 关联密度`

**法律案卷**: 将法条与判例进行向量化，结合案件细节（条件）调取参考 --> `判决辅助 = 证据链 x 语义检索`

**代码重构**: 将旧系统文档与 Git 记录索引化，指导新逻辑迁移 --> `系统可维护性 = 文档完整度 x 检索效率`

# COGNITIVE UPGRADE

```
+-------------------+         +-------------------+
|     BEFORE        |         |     AFTER         |
|                   |  --->   |                   |
| 依靠对话长度来记事 |         | 依靠结构化检索来回想 |
+-------------------+         +-------------------+
```

# ACTION PROTOCOL

- [ ] 配置冲刷：检查 `clawdbot.yaml` 中的 `memoryFlush` 阈值。
- [ ] 优化索引：定期手动清理 `MEMORY.md` 中的冗余条目，提升检索精度。
- [ ] 跨端同步：利用 Git 将工作空间同步，实现多终端共享同一份“数字分身”。
